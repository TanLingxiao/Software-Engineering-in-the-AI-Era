# 有效提示工程

## 什么是提示工程？

提示工程（Prompt Engineering）是指设计和优化输入给 LLM 的提示词，以获得更准确、更相关的输出的技术和艺术。

## 提示工程的核心原则

### 1. 明确性（Clarity）

❌ **不明确的提示**：
```
写一个函数
```

✅ **明确的提示**：
```
用 Python 写一个函数，接收一个整数列表作为参数，返回列表中的最大值。
要求：处理空列表的情况，并添加类型提示。
```

### 2. 具体性（Specificity）

提供具体的细节和约束条件：

```python
# 示例：具体的代码生成提示

"""
请用 JavaScript 实现以下功能：
1. 创建一个名为 validateEmail 的函数
2. 使用正则表达式验证电子邮件格式
3. 返回 true/false
4. 添加详细的注释说明
5. 包含至少 3 个测试用例
"""
```

### 3. 上下文（Context）

提供足够的背景信息：

```
上下文：我正在开发一个电商网站的后端 API
任务：设计一个 RESTful 端点来处理订单创建
要求：
- 使用 Node.js 和 Express
- 验证用户输入
- 返回适当的 HTTP 状态码
- 处理错误情况
```

## 提示工程技巧

### 技巧 1：使用角色扮演

为 LLM 分配一个特定的角色：

```
你是一位资深的 Python 开发者，拥有 10 年以上的经验。
请审查以下代码，并提供改进建议：
[代码内容]
```

### 技巧 2：提供示例

通过示例说明期望的输出格式：

```
输入：
- 任务：将日期转换为中文格式
- 示例：
  输入：2024-01-15
  输出：2024年1月15日

现在请转换以下日期：
- 2024-03-22
- 2024-12-31
```

### 技巧 3：思维链（Chain of Thought）

要求模型展示推理过程：

```
问题：一个数列：2, 6, 12, 20, 30, ?，下一个数字是什么？

请一步步思考：
1. 观察相邻数字之间的差值
2. 找出差值的规律
3. 根据规律计算下一个数字
4. 给出最终答案
```

### 技巧 4：少样本学习（Few-Shot Learning）

提供多个示例：

```
任务：将自然语言转换为 SQL 查询

示例 1：
输入：显示所有年龄大于 25 的用户
输出：SELECT * FROM users WHERE age > 25;

示例 2：
输入：按部门统计员工数量
输出：SELECT department, COUNT(*) FROM employees GROUP BY department;

示例 3：
输入：查找工资最高的 5 名员工
输出：SELECT * FROM employees ORDER BY salary DESC LIMIT 5;

现在请转换：
输入：显示销售部门的所有经理
输出：
```

### 技巧 5：约束条件

明确指定约束：

```
请写一个排序算法，要求：
1. 时间复杂度为 O(n log n)
2. 不使用内置排序函数
3. 添加详细注释
4. 包含时间复杂度分析
5. 代码不超过 50 行
```

## 提示模板

### 代码生成模板

```
角色：[角色描述]
任务：[具体任务]
语言：[编程语言]
要求：
- [要求 1]
- [要求 2]
- [要求 3]
示例：
[示例输入/输出]
```

### 代码审查模板

```
请审查以下代码：
[代码内容]

检查要点：
1. 代码风格和可读性
2. 潜在的 bug
3. 性能问题
4. 安全问题
5. 最佳实践

请提供：
- 发现的问题列表
- 每个问题的严重程度
- 改进建议
- 修改后的代码（如果需要）
```

### 调试辅助模板

```
我遇到了以下问题：

代码：
[代码内容]

错误信息：
[错误信息]

期望行为：
[期望行为]

实际行为：
[实际行为]

请帮我：
1. 分析问题的根本原因
2. 提供修复方案
3. 解释为什么会出现这个问题
```

## 常见提示工程模式

### 1. 迭代优化模式

```
第一轮提示：[初始提示]
→ 根据结果调整提示
→ 第二轮提示：[改进后的提示]
→ 继续迭代直到满意
```

### 2. 分解任务模式

将复杂任务分解为多个简单任务：

```
任务：创建一个完整的 Web 应用

分解：
1. 设计数据库模式
2. 实现 API 端点
3. 创建前端界面
4. 添加认证系统
5. 编写测试
```

### 3. 自我反思模式

要求模型自我检查：

```
请完成以下任务，然后检查你的答案：
[任务]

检查清单：
- [ ] 是否回答了所有问题
- [ ] 代码是否可以运行
- [ ] 是否遵循了所有要求
- [ ] 是否有更好的解决方案

如果发现问题，请重新生成答案。
```

## 提示工程最佳实践

### ✅ DO（应该做的）

| 实践 | 说明 |
|------|------|
| 使用清晰的标题 | 帮助模型理解结构 |
| 提供具体示例 | 明确期望的输出 |
| 分步骤说明复杂任务 | 降低理解难度 |
| 使用格式化 | 如 Markdown、代码块 |
| 迭代优化提示 | 根据结果调整 |

### ❌ DON'T（不应该做的）

| 实践 | 说明 |
|------|------|
| 模糊不清的描述 | 会导致不准确的输出 |
| 过长的提示 | 可能超出上下文窗口 |
| 矛盾的要求 | 会混淆模型 |
| 缺少上下文 | 模型无法理解意图 |
| 一次性要求过多 | 分解为多个任务 |

## 实战示例

### 示例 1：生成 API 文档

```
请为以下 API 端点生成完整的文档：

```python
@app.route('/api/users', methods=['GET', 'POST'])
def users():
    if request.method == 'GET':
        page = request.args.get('page', 1, type=int)
        per_page = request.args.get('per_page', 10, type=int)
        users = User.query.paginate(page=page, per_page=per_page)
        return jsonify({
            'users': [user.to_dict() for user in users.items],
            'total': users.total,
            'pages': users.pages
        })
    elif request.method == 'POST':
        data = request.get_json()
        user = User(**data)
        db.session.add(user)
        db.session.commit()
        return jsonify(user.to_dict()), 201
```

文档应包括：
1. 端点描述
2. 请求方法
3. 请求参数
4. 响应格式
5. 状态码
6. 错误处理
```

### 示例 2：重构代码

```
请重构以下代码以提高可读性和性能：

```javascript
function processData(data) {
    var result = [];
    for (var i = 0; i < data.length; i++) {
        if (data[i].active) {
            var item = {
                id: data[i].id,
                name: data[i].name,
                value: data[i].value * 2
            };
            result.push(item);
        }
    }
    return result;
}
```

重构要求：
1. 使用现代 JavaScript 语法（ES6+）
2. 提高代码可读性
3. 添加 JSDoc 注释
4. 保持相同的功能
5. 解释所做的改进
```

## 下一步

现在你已经掌握了提示工程的基础知识，让我们完成本周的作业：

→ [作业：LLM 提示游乐场](03-assignment.md)
